<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Reading Comprehension – Chinecherem Erinne</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
:root{
 --primary:#1e3a8a;
 --secondary:#2563eb;
 --accent:#0f766e;
 --card:#ffffff;
 --muted:#e5e7eb;
 --highlight:#fde68a;
}

*{box-sizing:border-box;margin:0;padding:0}

body{
 font-family:"Segoe UI",system-ui,sans-serif;
 background:linear-gradient(135deg,#e0e7ff,#f8fafc);
 padding:14px;
}

.container{
 max-width:950px;
 margin:auto;
 background:var(--card);
 padding:22px;
 border-radius:18px;
 box-shadow:0 12px 35px rgba(0,0,0,.12);
}

h1{
 text-align:center;
 color:var(--primary);
 font-size:1.9rem;
 margin-bottom:14px;
}

/* Navigation */
.nav{
 display:grid;
 grid-template-columns:repeat(3,1fr);
 gap:10px;
 margin-bottom:20px;
}

.nav button{
 padding:10px;
 font-size:.9rem;
 border-radius:12px;
 border:none;
 color:#fff;
 font-weight:600;
 cursor:pointer;
}

.nav button:nth-child(1){background:#2563eb}
.nav button:nth-child(2){background:#0f766e}
.nav button:nth-child(3){background:#7c3aed}

button:active{transform:scale(.97)}

/* Dropdowns */
.select-wrap{
 max-width:240px;
 margin:0 auto 10px;
 text-align:center;
 font-weight:600;
}

select{
 width:100%;
 padding:8px 10px;
 font-size:.9rem;
 border-radius:10px;
 border:2px solid var(--muted);
 background:#fff;
}

/* Passage */
.subtitle{
 font-size:1.6rem;
 text-align:center;
 font-weight:600;
 margin:24px 0;
 color:#0f172a;
 line-height:2;
}

.subtitle span{
 padding:2px 4px;
 border-radius:4px;
}
button{
 padding:14px;
 font-size:16px;
 border-radius:12px;
 border:none;
 background:linear-gradient(to bottom,#3b82f6,#1e40af);
 color:#fff;
 font-weight:600;
 cursor:pointer;
}
.subtitle span.active{
 background:var(--highlight);
}

/* Read button */
.read-btn{
 display:block;
 margin:0 auto;
 padding:10px 18px;
 font-size:.9rem;
 background:#2563eb;
 color:#fff;
 border:none;
 border-radius:12px;
 font-weight:600;
 cursor:pointer;
}

/* Question card */
.question-card{
 border:2px solid var(--secondary);
 border-radius:18px;
 padding:18px;
 margin-top:18px;
 background:#f8fafc;
}

.question-card h3{
 font-size:1.1rem;
 margin-bottom:14px;
}

.option{
 display:flex;
 gap:10px;
 padding:12px;
 background:#fff;
 border-radius:14px;
 border:2px solid var(--muted);
 cursor:pointer;
 font-size:.95rem;
 margin-bottom:10px;
}

.option input{margin-top:4px}

.controls{
 display:flex;
 justify-content:flex-end;
 margin-top:14px;
}

.controls button{
 padding:10px 16px;
 font-size:.9rem;
 background:#0f766e;
 color:#fff;
 border:none;
 border-radius:12px;
 font-weight:600;
}

/* Score */
.score-box{
 text-align:center;
 font-size:2.2rem;
 font-weight:900;
 margin:30px 0;
 color:var(--accent);
}

/* Analytics */
.analytics{
 display:grid;
 grid-template-columns:repeat(3,1fr);
 gap:14px;
 margin-top:20px;
}

.analytics div{
 background:#eef2ff;
 padding:18px;
 border-radius:16px;
 text-align:center;
}

/* Table */
table{
 width:100%;
 border-collapse:collapse;
 margin-top:16px;
 font-size:.9rem;
}

th,td{
 padding:10px;
 border-bottom:1px solid var(--muted);
 text-align:center;
}

th{background:#e0e7ff}

.hidden{display:none}

@media(max-width:700px){
 .nav{grid-template-columns:1fr}
 .subtitle{font-size:1.3rem}
}
</style>
</head>

<body>
<div class="container">
<h1>Reading Comprehension - A Day Without Electricity</h1>

<div class="nav">
<button onclick="showTab('reading')">Reading</button>
<button onclick="showTab('analytics')">Progress Analytics</button>
<button onclick="showTab('results')">Previous Results</button>
</div>

<div id="readingTab">
<div class="select-wrap">
Voice
<select id="voiceSelect"></select>
</div>

<div class="select-wrap">
Difficulty
<select id="difficultySelect">
<option value="easy">Easy</option>
<option value="medium" selected>Medium</option>
<option value="hard">Hard</option>
</select>
</div>

<div class="subtitle" id="subtitle">Click “Read Story” to begin</div>
<button class="read-btn" onclick="readPassage()">Read Story</button>

<div id="quiz" class="hidden"></div>
<div id="score" class="score-box"></div>
</div>

<div id="analyticsTab" class="hidden">
<h2 style="text-align:center">Progress Analytics</h2>
<div class="analytics">
<div>Attempts<br><span id="totalAttempts">0</span></div>
<div>Best Score<br><span id="bestScore">0%</span></div>
<div>Average Score<br><span id="avgScore">0%</span></div>
</div>
</div>

<div id="resultsTab" class="hidden">
<h2 style="text-align:center">Previous Results</h2>
<table>
<thead>
<tr><th>Date</th><th>Difficulty</th><th>Score</th></tr>
</thead>
<tbody id="resultsTable"></tbody>
</table>
</div>
</div>

<script>
const STUDENT_NAME="Chinecherem Erinne";

/* Firebase */
const firebaseConfig = {
  apiKey: "AIzaSyDHqc8J-YGIPtHPukHIKPcD1ctdBkUSDfg",
  authDomain: "project3-c23f6.firebaseapp.com",
  databaseURL: "https://project3-c23f6-default-rtdb.firebaseio.com",
  projectId: "project3-c23f6",
  storageBucket: "project3-c23f6.appspot.com",
  messagingSenderId: "983493979084",
  appId: "1:983493979084:web:2db0b954c965660edf0b69"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);

// Get a reference to the database
const db = firebase.database();


/* Tabs */
function showTab(t){
 ["reading","analytics","results"].forEach(x=>{
  document.getElementById(x+"Tab").classList.add("hidden");
 });
 document.getElementById(t+"Tab").classList.remove("hidden");
}

/* Voices */
speechSynthesis.onvoiceschanged=()=>{
 voiceSelect.innerHTML="";
 speechSynthesis.getVoices().filter(v=>v.lang.startsWith("en"))
 .forEach((v,i)=>{
  voiceSelect.innerHTML+=`<option value="${i}">${v.name}</option>`;
 });
};


/* Content */
const passages = {
  easy: [
    "One morning, Alex woke up and noticed that the lights in his house were not working. The refrigerator was off, and the TV could not turn on. He and his sister decided to play board games and read books instead. By evening, the electricity returned, and everyone was happy to have their gadgets back."
  ],

  medium: [
    "Alex woke up to find that the electricity in his house was gone. The lights were out, the refrigerator had stopped, and the TV did not work. At first, he felt bored, but he and his sister spent the day reading books, telling stories, and playing board games. When the power returned that evening, they realized they had enjoyed a day together without technology."
  ],

  hard: [
    "One bright morning, Alex discovered that the electricity in his house had stopped working. Lights were dark, the refrigerator was off, and electronic devices were useless. Initially frustrated, Alex and his sister decided to make the best of the situation. They read books, played board games, and shared stories, finding joy in simple activities. When the power returned that evening, they appreciated the experience and their time together."
  ]
};

/* Questions */
const questions = {
  easy: [
    {q:"What problem did Alex notice in the morning?", o:["He was late for school","The lights were not working","It was raining","His toys were missing"], a:1},
    {q:"Which appliance was not working?", o:["The TV","The refrigerator","The oven","The washing machine"], a:1},
    {q:"What did Alex and his sister do?", o:["Watched TV","Played board games and read books","Went shopping","Went outside"], a:1},
    {q:"How did they feel when electricity returned?", o:["Sad","Happy","Angry","Confused"], a:1},
    {q:"Which device could not turn on?", o:["TV","Laptop","Microwave","Phone"], a:0},
    {q:"The story mainly shows ______.", o:["Boredom without electricity","Fun during a blackout","Cooking with candles","Watching TV all day"], a:1},
    {q:"When did the electricity come back?", o:["By evening","At noon","At midnight","The next morning"], a:0},
    {q:"Alex and his sister spent the day ______.", o:["Playing outside","Reading and playing games","Sleeping","Using computers"], a:1},
    {q:"The day without electricity made them feel ______.", o:["Lonely","Happy to be together","Scared","Hungry"], a:1},
    {q:"The story teaches readers about ______.", o:["Enjoying simple activities","Always using gadgets","Cooking","Watching TV"], a:0}
  ],

  medium: [
    {q:"Why was Alex bored at first?", o:["He lost his toys","Electricity was gone","His sister was absent","It was raining"], a:1},
    {q:"What activities did they enjoy?", o:["Board games and stories","Watching TV","Playing video games","Cooking"], a:0},
    {q:"What appliance stopped working?", o:["Refrigerator","Microwave","Computer","Washing machine"], a:0},
    {q:"How did the day end?", o:["With electricity returning","With a trip outside","With a thunderstorm","With a movie night"], a:0},
    {q:"What did they realize by evening?", o:["They enjoyed the day together","They needed gadgets","They were bored","They missed school"], a:0},
    {q:"The main idea of the story is ______.", o:["Fun without electricity","Cooking at home","Sleeping all day","Watching TV"], a:0},
    {q:"Which emotion did they feel during the day?", o:["Joy","Fear","Anger","Sadness"], a:0},
    {q:"Where did the story take place?", o:["At home","In school","In a park","At a friend’s house"], a:0},
    {q:"The children spent time ______.", o:["Reading books and playing games","Sleeping","Watching TV","Using gadgets"], a:0},
    {q:"What does the story encourage?", o:["Enjoying time with family","Ignoring problems","Using gadgets","Going shopping"], a:0}
  ],

  hard: [
    {q:"What was the first sign of the electricity problem?", o:["Lights were dark","Refrigerator was full","TV was on","Oven was working"], a:0},
    {q:"How did Alex initially feel?", o:["Frustrated","Excited","Sleepy","Hungry"], a:0},
    {q:"What solution did they find for fun?", o:["Reading, board games, and stories","Going outside","Watching TV","Using gadgets"], a:0},
    {q:"What devices were useless?", o:["Electronic devices","Books","Board games","Pencils"], a:0},
    {q:"How did they react to the situation?", o:["Made the best of it","Ignored it","Felt angry all day","Went to school"], a:0},
    {q:"What lesson did they learn?", o:["Joy in simple activities","Always use electricity","Never play games","Avoid reading"], a:0},
    {q:"When did the electricity return?", o:["That evening","The next morning","After a week","Immediately"], a:0},
    {q:"What does this story mainly highlight?", o:["Spending time together","Technology is essential","Cooking","Shopping"], a:0},
    {q:"Which activity was NOT mentioned?", o:["Watching TV","Reading","Playing board games","Sharing stories"], a:0},
    {q:"The story’s theme can be described as ______.", o:["Appreciating simple joys","Reliance on gadgets","Fear of darkness","Being lazy"], a:0}
  ]
};




let difficulty,index,answers;

function readPassage(){
 difficulty=difficultySelect.value;
 index=0;answers=[];
 quiz.classList.add("hidden");
 score.innerText="";
 let lines=passages[difficulty],i=0;

 function speak(){
  if(i>=lines.length){startQuiz();return;}

  const words=lines[i].split(" ");
  subtitle.innerHTML=words.map(w=>`<span>${w}</span>`).join(" ");
  const spans=[...subtitle.querySelectorAll("span")];
  let wi=0;

  let u=new SpeechSynthesisUtterance(lines[i]);
  u.voice=speechSynthesis.getVoices()[voiceSelect.value];

  u.onboundary=e=>{
   if(e.name==="word"){
    spans.forEach(s=>s.classList.remove("active"));
    if(spans[wi]) spans[wi].classList.add("active");
    wi++;
   }
  };

  u.onend=()=>{i++;speak();};
  speechSynthesis.speak(u);
 }
 speak();
}

function startQuiz(){
 quiz.classList.remove("hidden");
 showQuestion();
}

function showQuestion(){
 let q=questions[difficulty][index];
 quiz.innerHTML=`
 <div class="question-card">
 <h3>${q.q}</h3>
 ${q.o.map((o,i)=>`
  <label class="option">
  <input type="radio" name="opt" value="${i}"> ${o}
  </label>`).join("")}
 <div class="controls">
 <button onclick="${index<questions[difficulty].length-1?'nextQuestion()':'submitQuiz()'}">
 ${index<questions[difficulty].length-1?'Next':'Submit'}
 </button>
 </div>
 </div>`;
}

function nextQuestion(){
 let s=document.querySelector("input[name='opt']:checked");
 if(!s){showModal(STUDENT_NAME+", please select an answer.");return;}
 answers.push(+s.value);
 index++;showQuestion();
}

function submitQuiz(){
 let s=document.querySelector("input[name='opt']:checked");
 if(!s){showModal(STUDENT_NAME+", please select an answer.");return;}
 answers.push(+s.value);

 let correct=answers.filter((v,i)=>v===questions[difficulty][i].a).length;
 let pct=Math.round(correct/answers.length*100);
 score.innerText=`Score: ${pct}%`;
 showModal(STUDENT_NAME+", your score is "+pct+"%");

 db.ref("results").push({student:STUDENT_NAME,difficulty,score:pct,timestamp:Date.now()});
 loadResults();
}

/* Results */
function loadResults(){
 db.ref("results").once("value",snap=>{
  let data=Object.values(snap.val()||{}).filter(r=>r.student===STUDENT_NAME);
  resultsTable.innerHTML="";
  let sum=0,best=0;
  data.forEach(r=>{
   sum+=r.score;best=Math.max(best,r.score);
   resultsTable.innerHTML+=`
   <tr><td>${new Date(r.timestamp).toLocaleString()}</td><td>${r.difficulty}</td><td>${r.score}%</td></tr>`;
  });
  totalAttempts.innerText=data.length;
  bestScore.innerText=best+"%";
  avgScore.innerText=data.length?Math.round(sum/data.length)+"%":"0%";
 });
}
loadResults();

/* CLEAN MODAL — NO AUTO CLOSE */
function showModal(message){
 const overlay=document.createElement("div");
 overlay.style=`position:fixed;inset:0;background:rgba(0,0,0,.55);display:flex;align-items:center;justify-content:center;z-index:9999`;

 const box=document.createElement("div");
 box.style=`background:#fff;padding:28px;border-radius:16px;max-width:420px;width:90%;text-align:center`;

 box.innerHTML=`
 <h3 style="color:#1e3a8a;margin-bottom:10px">Message</h3>
 <p style="margin-bottom:20px">${message}</p>
 <button>OK</button>
 `;

 box.querySelector("button").onclick=()=>document.body.removeChild(overlay);
 overlay.appendChild(box);
 document.body.appendChild(overlay);
}
</script>
</body>
</html>
